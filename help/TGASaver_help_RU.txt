// ----------------------------------------------------------------------------------------------------------
//
//		TGA saver tool v.1.5
//		Photoshop CS2 - CS5
//
// ----------------------------------------------------------------------------------------------------------

Назначение:
	Экспорт нескольких текстур за раз из соответствующих групп PSD файла (диффуза, нормалмапа, спекуляра, альфы и ...).
	Добавление суффиксов к файлам в зависимости от типа экспортируемой текстуры.
	Уменьшение размера текстуры в 2 и 4 раза с возможностью применения шарпа и контраста.
	Проверка размера текстуры на степень двойки.
	Экспорт любого из типов текстур как альфа-канала в выбранный тип экспортируемой группы.
	Симметричный экспорт текстур в репозиторий проекта (относительно папок 'models' и 'textures').
	Экспорт без сохранения файлов (файлы остаются открытыми в фотошоп).
	Экспорт подгрупп PSD файла в любые каналы экспортируемой текстуры по выбору.

Формат групп PSD файла:
	Для экспорта текстур группы в PSD файле должны быть названы правильно в соответствии с названиями слотов в файле TgaSaver_slots.xml.
	Для автоматического создания экспортируемых групп можно создать PSD файл с требуемым размером (Ctrl+N),
	вызвать TgaSaver и нажать кнопку 'create layers template'.
	Для экспорта текстур экспортируемые группы не обязательно должны быть видимыми.
	Слои и группы вне экспортируемых групп не будут экспортиться (даже если они видимы).
	Если выбран экспорт альфы в экспортируемую группу, то текстура будет экспортиться как 32 bpi (т.е. с альфа-каналом), а иначе как 24 bpi.
Формат наименования psd файла:
	<texture_name>.psd
	<texture_name>_#<version>.psd
	Часть названия PSD файла, начиная с _#, не будет добавляться в название файла и может использоваться для сохранения различных версий файла.
	К примеру, tex_01_#04.psd (версия файла №04) будет экспортиться в tex_01_df.tga (tex_01_nm.tga и т.д.).
Суффиксы типов текстур:
	Суффиксы добавляются к имени текстуры и обозначают её тип (диффуз, нормал ...).
	Суффиксы задаются в файле TgaSaver_slots.xml, который лежит в папке экспортёра.
Шаблоны текстур для экспорта:
	Для создания своих типов экспортируемых текстур используются шаблоны.
	Шаблоны задаются в файле TgaSaver_slots.xml, который лежит в папке с экспортёром.
	Пример шаблона: <value slot="diffuse" suffix="_df" fill="128;128;128"></value>, где:
			slot="diffuse" - тип экспортируемой текстуры и название группы слоёв при нажатии 'create layers template'.
							 При создании групп слоёв в ручную, необходимо давать названия группам аналогичные с этим параметром.
			suffix="_df" - суффикс, который будет добавляться в конец названия текстуры.
			fill="128;128;128" - цвет заливки слоя при нажатии 'create layers template'. Цифры представляют RGB значения,
								 каждая в диапазоне 0-255 и задаются последовательно через знак <;> без пробелов.
	Если задан параметр fill, то этот шаблон будет экспортиться как файл и в экспортёре помечается квадратным значком с белой окантовкой.
	Если заданы параметы fill_r, fill_g, fill_b, fill_a (некоторые из них или все сразу), то этот шаблон будет экспортиться в RGBA каналы,
	а в экспортёре этот слот помечается квадратом с вертикальными RGB полосами.
	Одновременно задавать параметры fill и параметры fill_r, fill_g, fill_b, fill_a нельзя.
	Файл шаблонов можно вызвать на редактирование нажав 'Open templates file' во вкладке Options.
Экспорт подгрупп текстурного слота в качестве RGBA каналов:
	Для экспорта текстурных слоёв в качестве каналов необходимо в файле TgaSaver_slots.xml задать шаблон, к примеру, 
	<value slot="mask" suffix="_mask" fill_r="128;128;128" fill_g="128;128;128"></value>. 
	Далее, при нажатии 'create layers template', создастся группа mask, а в ней группы (R) и (G).
	При экспорте создастся файл с суффиксом _mask в R канале которого будет	содержимое из папки (R), в G канале - содержимое (G),
	а канал B будет залит чёрным цветом (т.к. он не задан в шаблоне).
	Допустимые параметры заливки в шаблоне: fill_r (красный канал), fill_g (зелёный), fill_b (синий), fill_a (альфа канал).
	Их значения - цвет заливки слоя PSD файла по умолчанию.
Сохранение настроек экспортёра:
	Настройки экспортёра хранятся в файле TgaSaver_conf.xml, который лежит в папке с экспортёром.
	Если файл настроек не найден, то он создаётся при запуске экспортёра с дефолтными значениями.
	Для сброса настоек по умолчанию надо удалить файл настроек и перезапустить экспортёр.
	Сохранение настроек производится по клавише 'save settings'.
	Если сделать изменение настроек и просто нажать 'Export', то следующий вызов экспортёра будет со старыми настройками.
	При обновлении экспортёра желательно удалить старый файл конфигурации (если появляются ошибки).
Путь к проекту:
	Путь к проектам для симметричного копирования текстур находится в переменной окружения WORKING_PROJECTS_PATH.
	Путь до папки должен заканчиваться Assets (Unity3d) или base (Doom 3) и слешем. Например, D:\Unity\Project\Assets\ или D:\Doom 3\base\
	Переменную окружения и пути к проектам можно задать запустив файл set_work_dirs.bat (лежит в архиве с экспортёром),
	предварительно прописав в нём пути к проектам.
	Если после запуска set_work_dirs.bat в экспортёре нет изменений, то надо попробовать перезапустить фотошоп
	или перелогинится (сделать выход/вход пользователя).
	Папки при симметричном экспорте создаются автоматически.
	Если путь к проекту не правильный или не существует, симметричное копирование не происходит.
	Симметричное копирование производится относительно папок 'models' и 'textures'.
	Например, если в арт-репозитории PSD файл лежит по пути D:\Art\Models\Car01\Car01.psd,
	то текстуры будут копироваться в D:\Art\Models\Car01\ и в D:\Unity Projects\MyProject\Assets\Models\Car01\.
	Т.е. у них будут общий путь относительно папки 'models' (Models\Car01\). То же самое и относительно папки 'textures'.
Запуск экспортёра:
	Папку к экспортёром надо скопировать в <path to photoshop>\Presets\Scripts\.
	Tga saver можно вызвать из меню File->Scripts->TgaSaver Exporter GUI... (для экспортёра с показом окна),
		File->Scripts->TgaSaver Exporter NoGUI... (для экспортёра без показа окна),
		создать action (Alt+F9) на вызов скрипта и назначить ему горячую клавишу или
		назначить горячую клавишу на скрипт в Edit->Keyboard Shortcuts and Menus
Параметры экспортёра:
	Only export - позволяет экспортить файлы без сохранения.
Замечания:
	Из исходного PSD файла удаляется альфа-канал.
	Для слота нормалмапа в TgaSaver_slots.xml необходим параметр allowSharpen="false" для запрета применения к нему шарпа/контраста.
	В данный момент некоторые фичи экспортёра (симметричное копирование) работают только в Windows.
	Если при нажатии 'Open templates file' не открывается файл TgaSaver_slots.xml, то необходимо в операционной системе задать
	приложение по умолчанию для открытия xml файлов.
	TODO: Прервать экспорт без GUI можно клавишей Esc или кнопкой Cancel.
	Текстурные слоты в экспортёре выстраиваются в порядке их записи в TgaSaver_slots.xml.
	Текстурный слот, предназначенный для экспорта в RGBA каналы, не может быть добавлен как альфа к другому текстурному слоту.
	TODO: Альфа у PNG берётся из прозрачности цвета (в экспортёре альфа канал автоматически применяется к бэкграунду).




// ----------------------------------------------------------------------------------------------------------
// Версии
v 1.5
	Сделан экспорт без показа окна экспортёра (TgaSaver_NoGUI.jsx). При экспорте используются последние сохранённые настройки.
	Сделан экспорт подгрупп фотошопа текстурного слота в выбранные RGBA каналы файла.
	Файл TgaSaver_suffix.xml больше не используется.
	Теперь можно добавлять свои шаблоны типов текстур для экспорта.
	Шаблоны для экспорта и суффиксы теперь задаются в TgaSaver_slots.xml, который лежит в папке с экспортёром.
	Увеличено количество типов текстур для экспорта по умолчанию.
	Во вкладке Options появилась кнопка Help.
	Экспортёр в меню Scripts теперь появляется под названиями TgaSaver Exporter GUI и TgaSaver Exporter NoGUI.
	Сделана кнопка открывающая файл TgaSaver_slots.xml для редактирования.
	В TgaSaver_slots.xml введён параметр allowSharpen, позволяющий разрешать применение шарпа/контраста к выбранному слоту.
	Теперь показывается процесс экспорта и какая текстура генерится в данный момент.
	Поддерживаемые форматы для экспорта теперь tga, png, tiff, bmp.
v 1.4
	Изменён интерфейс (теперь используется flash со скином Kingnare).
	Панельки Downscale и Options теперь сворачиваются. Состояние свёрнутости панелек запоминается при закрытии экспортёра.
	Файл конфигурации сохраняется в TgaSaver_conf.xml, который лежит рядом с экспортёром.
	Типы текстур для экспорта теперь можно добавлять из списка (и удалять их) через кнопки Add texture slot и Del texture slot.
	Сделан альтернативный экспорт (флажок Only export). Текстуры при этом генерятся как и раньше, но остаются открытыми и 
	не сохраняются (полезно для сторонних экспортёров таких как CryTiff).
	При нажатии 'create layers template' теперь генерятся только группы, которые отображены в окне экспортёра.
	Значения суффиксов теперь задаются в TgaSaver_suffix.xml.
	Рефакторинг кода.
v 1.3
	Путей к проектам теперь может быть несколько.
	Пути задаются в переменной окружения WORKING_PROJECTS_PATH (для совместимости с Blender экспортёром).
	С экспортёром находятся bat-файл для создания переменной окружения (пример в файле).
	Возможность отдельного масштабирования при экспорте для каждого типа текстуры.
	Изменены положения некоторых элементов в гуи экспортёра.
	При нажатии 'create layers template' создаются слои с дефолтной заливкой (128 для диффуза, 0 для спекуляра, 128 128 255 для нормала).
v 1.2
	Первый публичный релиз.
	Написан мануал.
	Редизайн экспортёра.
	Добавлен экспорт глоу.
	Добавлено несколько предупреждений при неправильной комбинации настроек экспортёра.
	Исправлено симметричное копирование для юнити проекта.
	Добавлен выбор пути для экспорта альфы.
	Добавлен выбор пути для экспорта спекуляра.
	Добавлена кнопка сохранения настроек.
	Добавлена кнопка автоматического создания экспортируемых групп.
	Перенесено чтение пути к проекту из переменной среды в файл конфигурации.
	Сделана возможность не экспортить альфу (в меню 'Alpha to:' строка none).
	При создании дефолтных слоёв по кнопке 'create layers template' производится их заливка.
	Исправлен вывод ошибки о несуществующем пути к проекту при снятой галке.
v 1.1
	Исправлен экспорт альфы в альфа-канал спекуляра.
	Исправлено неправильное сохранение некоторых настроек.
	Исправлено сохранение при выходе из экспортёра по закрытию (без экспорта).
	Добавлена возможность выбрать суффиксы для текстур.
	Добавлена возможность экспортировать текстуры с любым размером (даже не степени двойки).
	Добавлено предупреждение если, размер текстуры не принадлежит степени двойки.
	Добавлен путь для симметричного копирования.
v 1.0
	Начальный релиз.
